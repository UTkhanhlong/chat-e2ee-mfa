export type UserRec={id:string;email:string;pass_hash:string;totp_secret?:string|null;totp_enabled?:boolean;backups?:string[]}; export interface Storage{ createUser(i:{email:string;pass_hash:string}):Promise<{id:string;email:string}>; findUserByEmail(email:string):Promise<UserRec|null>; addRefresh(userId:string,token:string):Promise<void>; rotateRefresh(oldT:string,newT:string,userId:string):Promise<boolean>; getMFA(userId:string):Promise<{totp_secret?:string|null;totp_enabled?:boolean;backups?:string[]}|null>; setTOTPSecret(userId:string,secret:string):Promise<void>; enableTOTP(userId:string,backups:string[]):Promise<void>; consumeBackup(userId:string,code:string):Promise<boolean>; }
